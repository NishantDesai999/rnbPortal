{"ast":null,"code":"import _defineProperty from \"E:\\\\Codes\\\\Github\\\\roadWebPortal\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/defineProperty\";\nimport _classCallCheck from \"E:\\\\Codes\\\\Github\\\\roadWebPortal\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"E:\\\\Codes\\\\Github\\\\roadWebPortal\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"E:\\\\Codes\\\\Github\\\\roadWebPortal\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"E:\\\\Codes\\\\Github\\\\roadWebPortal\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"E:\\\\Codes\\\\Github\\\\roadWebPortal\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"E:\\\\Codes\\\\Github\\\\roadWebPortal\\\\src\\\\Officer\\\\ComplaintContainer.js\";\nimport React, { Component } from 'react';\nimport { Route, Switch, Redirect } from 'react-router-dom';\nimport PropTypes from 'prop-types';\nimport { withStyles } from '@material-ui/core/styles';\nimport Slide from '@material-ui/core/Slide';\nimport CircularProgress from '@material-ui/core/CircularProgress';\nimport Grid from '@material-ui/core/Grid';\nimport SideFilter from \"../Components/SideFilter\";\nimport ComplaintTable from \"./ComplaintTable\";\nimport ComplaintReport from \"./ComplaintReport\";\nimport GeneralDialog from '../Components/GeneralDialog';\nimport { griev_type, status_type, getCookie, url } from '../constants'; // import Card from '@material-ui/core/Card';\n\nvar styles = function styles(theme) {\n  return {\n    progress: {\n      margin: theme.spacing.unit * 2\n    },\n    wrapper: {\n      // marginTop: '-56px',\n      // width: '100vw',\n      // height: '100vh',\n      display: 'flex'\n    }\n  };\n};\n\nvar ComplaintContainer =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(ComplaintContainer, _Component);\n\n  function ComplaintContainer() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, ComplaintContainer);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(ComplaintContainer)).call.apply(_getPrototypeOf2, [this].concat(args)));\n    _this.officers = [['SECTION OFFICER', true], ['DEPUTY EXCECUTIVE ENGINEER', true], ['EXCECUTIVE ENGINEER', true], ['SUPRETENDING ENGINEER', true], ['CHIEF ENGINEER', true]];\n    _this.state = {\n      StartingDate: new Date(),\n      EndingDate: new Date(),\n      griev_type_map: new Map(griev_type),\n      status_type_map: new Map(status_type),\n      officers: _this.officers,\n      startAnimation: false,\n      lodding: true,\n      filteredComplaints: []\n    };\n\n    _this.handleStartingDateChange = function (date) {\n      _this.setState({\n        StartingDate: date\n      });\n    };\n\n    _this.handleEndingDateChange = function (date) {\n      _this.setState({\n        EndingDate: date\n      });\n    };\n\n    _this.handleChange = function (name) {\n      return function (e) {\n        _this.setState({\n          lodding: true\n        });\n\n        var value = e.target.value;\n\n        _this.setState(function (oldState) {\n          var _ref;\n\n          var newMap = new Map(oldState[name]);\n          var checked = !newMap.get(value);\n          newMap.set(value, checked);\n          var newFilteredComplaints = [];\n\n          if (checked) {\n            if (name === \"status_type_map\") {\n              // console.log(\"adding status : \" + value ) \n              // console.log(this.allComplaints);\n              // console.log(oldState.griev_type_map);\n              newFilteredComplaints = _this.allComplaints.filter(function (complaint) {\n                return complaint.complaint_status && complaint.complaint_status.toUpperCase() == value.toUpperCase() && complaint.grievType && oldState.griev_type_map.get(complaint.grievType.toUpperCase());\n              });\n              newFilteredComplaints = oldState.filteredComplaints.concat(newFilteredComplaints); //console.log(newFilteredComplaints);\n            } else if (name === \"griev_type_map\") {\n              // console.log(\"adding status : \" + value ) \n              // console.log(this.allComplaints);\n              // console.log(oldState.status_type_map);\n              newFilteredComplaints = _this.allComplaints.filter(function (complaint) {\n                return complaint.grievType && complaint.grievType.toUpperCase() == value.toUpperCase() && complaint.complaint_status && oldState.status_type_map.get(complaint.complaint_status.toUpperCase());\n              });\n              newFilteredComplaints = oldState.filteredComplaints.concat(newFilteredComplaints); //console.log(newFilteredComplaints);\n            }\n          } else {\n            console.log(\"removing\", oldState.filteredComplaints);\n            var jsonName = null;\n\n            if (name === \"status_type_map\") {\n              jsonName = \"complaint_status\";\n            } else if (name === \"griev_type_map\") {\n              jsonName = \"grievType\";\n            }\n\n            console.log(value, oldState.filteredComplaints[0][jsonName] && oldState.filteredComplaints[0][jsonName].toUpperCase());\n            newFilteredComplaints = oldState.filteredComplaints.filter(function (complaint) {\n              return complaint[jsonName] && complaint[jsonName].toUpperCase() !== value.toUpperCase();\n            });\n            console.log(newFilteredComplaints);\n          }\n\n          return _ref = {}, _defineProperty(_ref, name, newMap), _defineProperty(_ref, \"lodding\", false), _defineProperty(_ref, \"filteredComplaints\", newFilteredComplaints), _ref;\n        });\n      };\n    };\n\n    _this.allComplaints = [];\n\n    _this.handleDialogOpen = function (dialogMsg, dialogTitle) {\n      _this.setState({\n        openDialog: true,\n        dialogMsg: dialogMsg,\n        dialogTitle: dialogTitle\n      });\n    };\n\n    _this.handleClose = function () {\n      _this.setState({\n        openDialog: false\n      });\n    };\n\n    return _this;\n  }\n\n  _createClass(ComplaintContainer, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var _this2 = this;\n\n      this.setState({\n        startAnimation: true\n      }); // console.log(getCookie(\"roadGPortalAuth\"));\n\n      var headers = new Headers();\n      headers.append('origin', '*');\n      headers.append('auth', 'token ' + getCookie(\"roadGPortalAuth\"));\n      var req = new Request(url + \"getComplaints?isPaginated=0\", {\n        method: \"GET\",\n        headers: headers,\n        mode: 'cors'\n      });\n      fetch(req).then(function (res) {\n        return res.json();\n      }).then(function (res) {\n        _this2.setState({\n          lodding: false\n        });\n\n        if (res.success) {\n          res.complaints.map(function (complaint) {\n            complaint.time = new Date(complaint.time);\n          });\n          _this2.allComplaints = res.complaints;\n          console.log(_this2.allComplaints);\n\n          _this2.setState({\n            filteredComplaints: res.complaints\n          });\n        } else {\n          _this2.handleDialogOpen(res.data, \"Error\");\n        }\n      }).catch(function (err) {\n        console.log(err);\n\n        _this2.setState({\n          lodding: false\n        });\n\n        _this2.handleDialogOpen(err.message, \"Error\");\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this3 = this;\n\n      var classes = this.props.classes;\n      return React.createElement(\"div\", {\n        className: classes.wrapper,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 213\n        },\n        __self: this\n      }, React.createElement(GeneralDialog, {\n        openDialogState: this.state.openDialog,\n        dialogTitle: this.state.dialogTitle,\n        dialogMsg: this.state.dialogMsg,\n        handleClose: this.handleClose,\n        handleDialogOpen: this.handleDialogOpen,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 214\n        },\n        __self: this\n      }), React.createElement(Grid, {\n        container: true,\n        spacing: 8,\n        style: {\n          margin: 'auto'\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 223\n        },\n        __self: this\n      }, React.createElement(Grid, {\n        item: true,\n        sm: 3,\n        xs: 12,\n        style: {\n          height: '90vh',\n          overflowY: 'scroll'\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 224\n        },\n        __self: this\n      }, React.createElement(Slide, {\n        direction: \"right\",\n        in: true,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 225\n        },\n        __self: this\n      }, React.createElement(SideFilter, {\n        status_type_map: this.state.status_type_map,\n        griev_type_map: this.state.griev_type_map,\n        handleChange: this.handleChange,\n        handleEndingDateChange: this.handleEndingDateChange,\n        handleStartingDateChange: this.handleStartingDateChange,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 226\n        },\n        __self: this\n      }))), React.createElement(Grid, {\n        item: true,\n        sm: 9,\n        xs: 12,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 233\n        },\n        __self: this\n      }, this.state.lodding ? React.createElement(CircularProgress, {\n        className: classes.progress,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 236\n        },\n        __self: this\n      }) : React.createElement(\"div\", {\n        style: {\n          margin: '10px',\n          height: '80vh',\n          overflowY: 'scroll'\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 238\n        },\n        __self: this\n      }, React.createElement(Switch, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 239\n        },\n        __self: this\n      }, React.createElement(Route, {\n        exact: true,\n        path: \"/Dashboard/Complaints/Table\",\n        render: function render() {\n          return React.createElement(ComplaintTable, {\n            complaintsData: _this3.state.filteredComplaints,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 240\n            },\n            __self: this\n          });\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 240\n        },\n        __self: this\n      }), React.createElement(Route, {\n        exact: true,\n        path: \"/Dashboard/Complaints/Reports\",\n        render: function render() {\n          return React.createElement(ComplaintReport, {\n            complaintsData: _this3.state.filteredComplaints,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 241\n            },\n            __self: this\n          });\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 241\n        },\n        __self: this\n      }), React.createElement(Route, {\n        exact: true,\n        path: \"/Dashboard/Complaints/Maps\",\n        render: function render() {\n          return React.createElement(\"h1\", {\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 242\n            },\n            __self: this\n          }, \"Complaint Maps\");\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 242\n        },\n        __self: this\n      }), React.createElement(Route, {\n        path: \"/Dashboard/Complaints/*\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 243\n        },\n        __self: this\n      }, React.createElement(Redirect, {\n        to: \"/Dashboard/\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 244\n        },\n        __self: this\n      })))))));\n    }\n  }]);\n\n  return ComplaintContainer;\n}(Component);\n\nComplaintContainer.propTypes = {\n  classes: PropTypes.object.isRequired\n};\nexport default withStyles(styles)(ComplaintContainer);","map":{"version":3,"sources":["E:\\Codes\\Github\\roadWebPortal\\src\\Officer\\ComplaintContainer.js"],"names":["React","Component","Route","Switch","Redirect","PropTypes","withStyles","Slide","CircularProgress","Grid","SideFilter","ComplaintTable","ComplaintReport","GeneralDialog","griev_type","status_type","getCookie","url","styles","theme","progress","margin","spacing","unit","wrapper","display","ComplaintContainer","officers","state","StartingDate","Date","EndingDate","griev_type_map","Map","status_type_map","startAnimation","lodding","filteredComplaints","handleStartingDateChange","date","setState","handleEndingDateChange","handleChange","name","e","value","target","oldState","newMap","checked","get","set","newFilteredComplaints","allComplaints","filter","complaint","complaint_status","toUpperCase","grievType","concat","console","log","jsonName","handleDialogOpen","dialogMsg","dialogTitle","openDialog","handleClose","headers","Headers","append","req","Request","method","mode","fetch","then","res","json","success","complaints","map","time","data","catch","err","message","classes","props","height","overflowY","propTypes","object","isRequired"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport { Route, Switch, Redirect } from 'react-router-dom';\n\nimport PropTypes from 'prop-types';\nimport { withStyles } from '@material-ui/core/styles';\nimport Slide from '@material-ui/core/Slide';\n\nimport CircularProgress from '@material-ui/core/CircularProgress';\nimport Grid from '@material-ui/core/Grid';\n\nimport SideFilter from \"../Components/SideFilter\";\nimport ComplaintTable from \"./ComplaintTable\";\nimport ComplaintReport from \"./ComplaintReport\";\nimport GeneralDialog from '../Components/GeneralDialog';\nimport { griev_type,status_type,getCookie, url } from '../constants';\n// import Card from '@material-ui/core/Card';\n\nconst styles = theme => ({\n    progress: {\n        margin: theme.spacing.unit * 2,\n    },\n    wrapper: {\n        // marginTop: '-56px',\n        // width: '100vw',\n        // height: '100vh',\n        display: 'flex'\n    }\n})\n\nclass ComplaintContainer extends Component {\n\n    officers = [\n        ['SECTION OFFICER',true],\n        ['DEPUTY EXCECUTIVE ENGINEER',true],\n        ['EXCECUTIVE ENGINEER',true],\n        ['SUPRETENDING ENGINEER',true],\n        ['CHIEF ENGINEER',true]\n    ]\n\n    state = {\n        StartingDate: new Date(),\n        EndingDate: new Date(),\n        griev_type_map: new Map(griev_type),\n        status_type_map : new Map(status_type),\n        officers: this.officers,\n        startAnimation: false,\n        lodding : true,\n        filteredComplaints: []\n    }\n\n    handleStartingDateChange = (date) => {\n        this.setState({ StartingDate: date });\n    }\n\n    handleEndingDateChange = (date) => {\n        this.setState({ EndingDate: date }); \n    }\n\n    handleChange = name => e  => {\n\n        \n        this.setState({\n            lodding : true\n        });\n\n        const value = e.target.value;\n        this.setState( oldState  => {\n            \n            const newMap = new Map(oldState[name]);\n            const checked = !newMap.get(value)\n            newMap.set(value,checked);\n\n            let newFilteredComplaints = [];\n\n            \n            if(checked){\n                \n                if(name === \"status_type_map\"){\n                    // console.log(\"adding status : \" + value ) \n                    // console.log(this.allComplaints);\n                    // console.log(oldState.griev_type_map);\n                    \n                    newFilteredComplaints = this.allComplaints.filter(complaint => {\n                            \n                            return complaint.complaint_status\n                                && complaint.complaint_status.toUpperCase() == value.toUpperCase() \n                                && complaint.grievType\n                                && oldState.griev_type_map.get(complaint.grievType.toUpperCase())\n                        });\n                    \n                    newFilteredComplaints = oldState.filteredComplaints.concat(newFilteredComplaints)\n                    //console.log(newFilteredComplaints);\n\n                }else if(name === \"griev_type_map\"){\n                            \n                    // console.log(\"adding status : \" + value ) \n                    // console.log(this.allComplaints);\n                    // console.log(oldState.status_type_map);\n                    \n                    newFilteredComplaints = this.allComplaints.filter(complaint => {\n                            \n                            return complaint.grievType\n                                && complaint.grievType.toUpperCase() == value.toUpperCase() \n                                && complaint.complaint_status\n                                && oldState.status_type_map.get(complaint.complaint_status.toUpperCase())\n                        });\n                    \n                    newFilteredComplaints = oldState.filteredComplaints.concat(newFilteredComplaints)\n                    //console.log(newFilteredComplaints);\n\n                }\n\n            }else{\n                console.log(\"removing\",oldState.filteredComplaints);\n                let jsonName = null;\n                if(name === \"status_type_map\"){\n                    jsonName = \"complaint_status\";\n                }else if(name === \"griev_type_map\"){\n                    jsonName = \"grievType\"\n                }\n\n                console.log(value,oldState.filteredComplaints[0][jsonName] && (oldState.filteredComplaints[0][jsonName].toUpperCase()));\n\n                newFilteredComplaints = oldState.filteredComplaints.filter(complaint => (\n                    complaint[jsonName] && (complaint[jsonName].toUpperCase() !== value.toUpperCase())\n                ));\n                console.log(newFilteredComplaints);\n                \n            }\n\n\n            return {\n                [name] : newMap,\n                lodding : false,\n                filteredComplaints : newFilteredComplaints\n            }\n          });\n\n\n    }\n\n\n    allComplaints = []\n\n\n    handleDialogOpen = (dialogMsg, dialogTitle) => {        \n        this.setState({ \n            openDialog: true,\n            dialogMsg: dialogMsg,\n            dialogTitle: dialogTitle\n        });\n    };\n\n    handleClose = () => {\n        this.setState({ openDialog: false });\n    };\n\n    componentDidMount() {\n        this.setState({\n            startAnimation: true,\n        })\n\n        // console.log(getCookie(\"roadGPortalAuth\"));\n        \n\n        let headers = new Headers();\n        headers.append('origin', '*');\n        headers.append('auth', 'token ' + getCookie(\"roadGPortalAuth\"));\n\n        let req = new Request(url  + \"getComplaints?isPaginated=0\", {\n            method: \"GET\",\n            headers: headers,\n            mode: 'cors'\n        });\n\n        fetch(req)\n            .then(res => res.json())\n            .then(res => {\n                \n                this.setState({\n                    lodding : false\n                });\n\n                if(res.success){\n                    res.complaints.map(complaint => {\n                        complaint.time = new Date(complaint.time);\n                    })\n                    \n                    this.allComplaints = res.complaints;\n                    \n                    console.log(this.allComplaints);\n                    \n                    this.setState({\n                        filteredComplaints : res.complaints,\n                    })\n                }else{\n                    this.handleDialogOpen(res.data, \"Error\");\n                }\n            })\n            .catch(err => {\n                console.log(err);      \n                this.setState({\n                    lodding : false\n                });          \n                this.handleDialogOpen(err.message, \"Error\")\n            });\n    }\n\n    render() {\n        let { classes } = this.props;\n\n        return (\n          <div className={classes.wrapper}>\n            <GeneralDialog \n                openDialogState = {this.state.openDialog}\n                dialogTitle = {this.state.dialogTitle}\n                dialogMsg = {this.state.dialogMsg}  \n                handleClose={this.handleClose}\n                handleDialogOpen={this.handleDialogOpen}\n            >\n                {/* <Button>Hello</Button> */}\n            </GeneralDialog>\n            <Grid container spacing={8} style={{margin:'auto'}}>\n                <Grid item sm={3} xs={12} style={{height: '90vh', overflowY:'scroll'}}>\n                    <Slide direction=\"right\" in={true}>\n                        <SideFilter status_type_map={this.state.status_type_map}  griev_type_map={this.state.griev_type_map} \n                                    handleChange={this.handleChange}\n                                    handleEndingDateChange = {this.handleEndingDateChange}\n                                    handleStartingDateChange ={this.handleStartingDateChange}\n                        /> \n                    </Slide>\n                </Grid>\n                <Grid item sm={9} xs={12} >\n                    \n                    {this.state.lodding\n                        ? (<CircularProgress className={classes.progress} />)\n                        :\n                        (<div style={{margin: '10px', height: '80vh', overflowY:'scroll'}}>\n                            <Switch >\n                                <Route exact path=\"/Dashboard/Complaints/Table\" render={() => (<ComplaintTable complaintsData={this.state.filteredComplaints} />)} />\n                                <Route exact path=\"/Dashboard/Complaints/Reports\" render={() => (<ComplaintReport complaintsData={this.state.filteredComplaints} />)} />\n                                <Route exact path=\"/Dashboard/Complaints/Maps\" render={() => (<h1>Complaint Maps</h1>)} />\n                                <Route path=\"/Dashboard/Complaints/*\">\n                                    <Redirect to=\"/Dashboard/\" />\n                                </Route>\n                            </Switch>\n                        </div>)\n                    }\n                </Grid>\n            </Grid>\n          </div>  \n        );\n    }\n}\n\nComplaintContainer.propTypes = {\n    classes: PropTypes.object.isRequired,\n};\n\nexport default withStyles(styles)(ComplaintContainer);"]},"metadata":{},"sourceType":"module"}